{"version":3,"sources":["commands/start.js"],"names":["projectDir","options","currentStatus","projectState","error","process","exit","warn","optsAsync","gray","root","resolve","startOpts","clear","reset","startAsync","constructManifestUrlAsync","url","printQRCode","underline","raw","getRecipient","sendTo","recipient","sendUrlAsync","handleMobileOptsAsync","green","action","program","command","alias","description","option","urlOpts","allowNonInteractive","allowOffline","asyncActionProjectDir"],"mappings":";;;;;;;;;;;;;;;;;;;8HAcA,iBAAsBA,UAAtB,EAAkCC,OAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAC6B,8BAAQC,aAAR,CAAsBF,UAAtB,CAD7B;;AAAA;AACQG,wBADR;;;AAGE,gBAAIA,iBAAiB,SAArB,EAAgC;AAC9B,4CAAIC,KAAJ,CAAU,qDAAV;AACAC,sBAAQC,IAAR,CAAa,CAAb;AACD,aAHD,MAGO,IAAIH,iBAAiB,KAArB,EAA4B;AACjC,4CAAII,IAAJ,CACE,0FADF;AAGD;;AAED,0DAAiBP,UAAjB;;AAZF;AAAA,mBAcQ,sCAAQQ,SAAR,CAAkBR,UAAlB,EAA8BC,OAA9B,CAdR;;AAAA;;AAgBE,+CAAI,oCAAOQ,IAAP,CAAY,kBAAZ,EAAgCT,UAAhC,CAAJ;;AAEIU,gBAlBN,GAkBa,cAAKC,OAAL,CAAaX,UAAb,CAlBb;AAmBMY,qBAnBN,GAmBkB,EAnBlB;;AAoBE,gBAAIX,QAAQY,KAAZ,EAAmB;AACjBD,wBAAUE,KAAV,GAAkB,IAAlB;AACD;;AAtBH;AAAA,mBAwBQ,8BAAQC,UAAR,CAAmBL,IAAnB,EAAyBE,SAAzB,CAxBR;;AAAA;;AA0BE,+CAAI,gBAAJ;;AA1BF;AAAA,mBA4BkB,+BAASI,yBAAT,CAAmChB,UAAnC,CA5BlB;;AAAA;AA4BMiB,eA5BN;;;AA8BE,+CAAI,8BAAJ;AACA,kDAAQC,WAAR,CAAoBD,GAApB;;AAEA,+CAAI,oBAAoB,oCAAOE,SAAP,CAAiBF,GAAjB,CAApB,GAA4C,IAAhD;AACA,0CAAIG,GAAJ,CAAQH,GAAR;;AAlCF;AAAA,mBAoC0B,oCAAOI,YAAP,CAAoBpB,QAAQqB,MAA5B,CApC1B;;AAAA;AAoCQC,qBApCR;;AAAA,iBAqCMA,SArCN;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAsCU,oCAAOC,YAAP,CAAoBP,GAApB,EAAyBM,SAAzB,CAtCV;;AAAA;AAAA;AAAA,mBAyCQ,sCAAQE,qBAAR,CAA8BzB,UAA9B,EAA0CC,OAA1C,CAzCR;;AAAA;;AA2CE,+CACE,oCAAOyB,KAAP,CACE,gEADF,CADF;;AA3CF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;kBAAeC,M;;;;;;;AAVf;AAAA;AAAA;;;;AAEA;AAAA;AAAA;;AACA;;;;AAEA;AAAA;AAAA;;;;AACA;AAAA;AAAA;;;;AACA;AAAA;AAAA;;;;AACA;AAAA;AAAA;;;;kBAoDe,UAACC,OAAD,EAAkB;AAC/BA,UACGC,OADH,CACW,qBADX,EAEGC,KAFH,CAES,GAFT,EAGGC,WAHH,CAII,0EAJJ,EAMGC,MANH,CAOI,sBAPJ,EAQI,oDARJ,EAUGA,MAVH,CAUU,aAVV,EAUyB,uCAVzB,EAWGC,OAXH,GAYGC,mBAZH,GAaGC,YAbH,GAcGC,qBAdH,CAcyBT,MAdzB;AAeD,C","file":"../../commands/start.js","sourcesContent":["/**\n * @flow\n */\n\nimport { Project, UrlUtils } from 'xdl';\n\nimport crayon from '@ccheever/crayon';\nimport path from 'path';\n\nimport log from '../log';\nimport sendTo from '../sendTo';\nimport { installExitHooks } from '../exit';\nimport urlOpts from '../urlOpts';\n\nasync function action(projectDir, options) {\n  const projectState = await Project.currentStatus(projectDir);\n\n  if (projectState === 'running') {\n    log.error('exp is already running for this project. Exiting...');\n    process.exit(1);\n  } else if (projectState === 'ill') {\n    log.warn(\n      'exp may have exited improperly. Proceeding, but you should check for orphaned processes.'\n    );\n  }\n\n  installExitHooks(projectDir);\n\n  await urlOpts.optsAsync(projectDir, options);\n\n  log(crayon.gray('Using project at', projectDir));\n\n  let root = path.resolve(projectDir);\n  let startOpts = {};\n  if (options.clear) {\n    startOpts.reset = true;\n  }\n\n  await Project.startAsync(root, startOpts);\n\n  log('Expo is ready.');\n\n  let url = await UrlUtils.constructManifestUrlAsync(projectDir);\n\n  log('You can scan this QR code:\\n');\n  urlOpts.printQRCode(url);\n\n  log('Your URL is\\n\\n' + crayon.underline(url) + '\\n');\n  log.raw(url);\n\n  const recipient = await sendTo.getRecipient(options.sendTo);\n  if (recipient) {\n    await sendTo.sendUrlAsync(url, recipient);\n  }\n\n  await urlOpts.handleMobileOptsAsync(projectDir, options);\n\n  log(\n    crayon.green(\n      'Logs for your project will appear below. Press Ctrl+C to exit.'\n    )\n  );\n}\n\nexport default (program: any) => {\n  program\n    .command('start [project-dir]')\n    .alias('r')\n    .description(\n      'Starts or restarts a local server for your app and gives you a URL to it'\n    )\n    .option(\n      '-s, --send-to [dest]',\n      'A phone number or e-mail address to send a link to'\n    )\n    .option('-c, --clear', 'Clear the React Native packager cache')\n    .urlOpts()\n    .allowNonInteractive()\n    .allowOffline()\n    .asyncActionProjectDir(action);\n};\n"],"sourceRoot":"/Users/jesseruder/exponent/universe/dev/exp/src"}